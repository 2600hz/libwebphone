<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>2600Hz Webphone Library</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width initial-scale=1.0">

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	
		<script src="dist/libwebphone.js" type="text/javascript"></script>
	<body>
		<script>
			var webphone = new libwebphone({mediaDevices: {root: {element_id: 'media_device_preview'}}});
		</script>

		<div class="container-fluid">
			<div class="row">
				<div class="col" style="border: solid;">
					<div class="row">
						<div class="col" style="text-align: center; border-bottom: dashed; padding: 10px;">
							<div>
								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.mute('audioinput'));">Mute Audio</button>
								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.unmute('audioinput'));">Unmute Audio</button>
								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.toggleMute('audioinput'));">Toggle Audio Mute</button>

								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.mute('videoinput'));">Mute Video</button>
								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.unmute('videoinput'));">Unmute Video</button>
								<button onclick="webphone.getMediaDevices().then(mediaDevices => mediaDevices.toggleMute('videoinput'));">Toggle Video Mute</button>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col" style="border-right: dashed;">
							<div id="media_device_preview"> </div>
						</div>
						<div class="col" style="border-right: dashed;">
							<script type="text/javascript">
								var customConfig = {
									audiooutput:{
										live_preview:false
									},
									audioinput:{ 
										live_preview:false
									},
									videoinput:{ 
										live_preview:false
									},
									root:{ 
										element_id:'media_device_selector'
									}
								};
								webphone.getMediaDevices().then(mediaDevices => {;
									mediaDevices.render(customConfig);
								});			
							</script>
							<div id="media_device_selector"> </div>
						</div>
						<div class="col">
							<script type="text/javascript">
								var template = `
									<div>
										<legend>{{i18n.legend}}</legend>

										{{#videoinput.enabled}}          
											<div>
												<label for="{{selectors.videoinput.element_id}}">
													{{i18n.videoinput}}
												</label>                
												<select id="{{selectors.videoinput.element_id}}">
													{{#videoinput.devices}}
														{{#connected}}
															<option value="{{id}}" {{#active}}selected{{/active}}>{{name}}</option>
														{{/connected}}
													{{/videoinput.devices}}
												</select>
											</div>
										{{/videoinput.enabled}}

										{{#audiooutput.enabled}}
											<div>
												<label for="{{selectors.audiooutput.element_id}}" style="display: inline-block">
													{{i18n.audiooutput}}:
												</label>
												<span id="{{selectors.audiooutput.element_id}}">
													{{#audiooutput.devices}}
														{{#active}}
															{{name}}
														{{/active}}
													{{/audiooutput.devices}}
												</span>
											</div>
										{{/audiooutput.enabled}}

										{{#audioinput.enabled}}
											<div>
												<label for="{{selectors.audioinput.element_id}}">
													{{i18n.audioinput}}:
												</label>
												<div id="{{selectors.audioinput.element_id}}">
													{{#audioinput.devices}}
														{{#connected}}
															<div>
																<input type="radio" name="audioinput" value="{{id}}" {{#active}}checked="checked"{{/active}}
																onclick="webphone.getMediaDevices().then(mediaDevices => {
																			mediaDevices.changeInputDevice('audioinput', event.target.value);
																		});
																">
																<label>{{name}}</label>
															</div>
														{{/connected}}    
													{{/audioinput.devices}}
												</div>               
											</div>
										{{/audioinput.enabled}}
									</div>
									`;
									var customTemplateConfig = {
										template: template,
										root: {
											element_id: 'media_device_custom'
										},
										selectors: {
											audioinput: {
												element_id: 'customized_audio_input'
											}
										}
									};

									webphone.getMediaDevices().then(mediaDevices => {;
										mediaDevices.render(customTemplateConfig).then(() => {
											document.querySelectorAll('#customized_audio_input > div > input[type=radio]').forEach(radio => {
												console.log('found radio button after render succeeded: ', radio);
											});
										});
									});
							</script>
							<div id="media_device_custom"> </div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</body>
</html>
