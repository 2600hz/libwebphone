<!DOCTYPE html>
<html>
  <head>
    <style>
      .wrapper {
        background-color: #3c6446;
        width: 320px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-gap: 5px;
        grid-auto-rows: minmax(100px, auto);
      }
      .wrapper button {
        width: 75%;
        height: 75%;
        margin: auto;
        font-size: 14px;
        border-radius: 50%;
      }
      .spinner {
        margin: 100px auto 0;
        width: 70px;
        text-align: center;
      }

      .spinner > div {
        width: 18px;
        height: 18px;
        background-color: #333;

        border-radius: 100%;
        display: inline-block;
        -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;
        animation: sk-bouncedelay 1.4s infinite ease-in-out both;
      }

      .spinner .bounce1 {
        -webkit-animation-delay: -0.32s;
        animation-delay: -0.32s;
      }

      .spinner .bounce2 {
        -webkit-animation-delay: -0.16s;
        animation-delay: -0.16s;
      }

      @-webkit-keyframes sk-bouncedelay {
        0%,
        80%,
        100% {
          -webkit-transform: scale(0);
        }
        40% {
          -webkit-transform: scale(1);
        }
      }

      @keyframes sk-bouncedelay {
        0%,
        80%,
        100% {
          -webkit-transform: scale(0);
          transform: scale(0);
        }
        40% {
          -webkit-transform: scale(1);
          transform: scale(1);
        }
      }
    </style>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>2600Hz Webphone Library</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width initial-scale=1.0" />

    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />

    <script src="dist/libwebphone.js" type="text/javascript"></script>

    <script type="text/javascript">
      var config = {
        dialpad: {
          renderTargets: ["dialpad"]
        },
        callList: {
          renderTargets: ["call_list"]
        },
        callControl: {
          renderTargets: ["call_control"]
        },
        mediaDevices: {
          videoinput: {
            startMuted: true
          },
          audioinput: {
            preferedDeviceIds: [
              "dfc8e6eb62fa04a069c4ae294119bdb60eebc352e9978661585e440d6baa5d62"
            ]
          },
          renderTargets: [
            "media_device_preview",
            {
              root: {
                elementId: "media_device_selector"
              },
              audiooutput: {
                livePreview: false
              },
              audioinput: {
                livePreview: true
              },
              videoinput: {
                livePreview: false
              }
            }
          ]
        },
        userAgent: {
          renderTargets: ["user_agent"],
          transport: {
            sockets: ["wss://sandbox.2600hz.com:5065"],
            recovery_max_interval: 30,
            recovery_min_interval: 2
          },
          authentication: {
            username: "user_q5eNt95vwv",
            password: "cxNMVV2BD47J",
            realm: "vbbZ65Q.sb.2600hz.com"
          },
          user_agent: {
            //contact_uri: '',
            //display_name: '',
            instance_id: "8f1fa16a-1165-4a96-8341-785b1ef24f12",
            no_answer_timeout: 60,
            register: true,
            register_expires: 300,
            user_agent: "libwebphone 2.x - dev"
          }
        }
      }; //End ofConfig

      var webphone = new libwebphone(config);
      webphone.onAny((event, ...data) => console.log(event, data));
    </script>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row" style="border: solid;">
        <div class="col" style="border-right: dashed;">
          Audio Input:
          <span id="audio_mute_status">UNMUTED</span>
          <script type="text/javascript">
            webphone.on(
              "mediaDevices.audio.input.muted",
              () =>
                (document.querySelector("#audio_mute_status").innerHTML =
                  "MUTED  ")
            );
            webphone.on(
              "mediaDevices.audio.input.unmuted",
              () =>
                (document.querySelector("#audio_mute_status").innerHTML =
                  "UNMUTED")
            );
          </script>
          <div>
            <button onclick="webphone.getMediaDevices().mute('audioinput');">
              Mute Audio
            </button>
            <button onclick="webphone.getMediaDevices().unmute('audioinput');">
              Unmute Audio
            </button>
            <button
              onclick="webphone.getMediaDevices().toggleMute('audioinput');"
            >
              Toggle Audio Mute
            </button>
          </div>
        </div>
        <div class="col" style="border-right: dashed;">
          Video Input:
          <span id="video_mute_status">UNMUTED</span>
          <script type="text/javascript">
            webphone.on(
              "mediaDevices.video.input.muted",
              () =>
                (document.querySelector("#video_mute_status").innerHTML =
                  "MUTED  ")
            );
            webphone.on(
              "mediaDevices.video.input.unmuted",
              () =>
                (document.querySelector("#video_mute_status").innerHTML =
                  "UNMUTED")
            );
          </script>
          <div>
            <button onclick="webphone.getMediaDevices().mute('videoinput');">
              Mute Video
            </button>
            <button onclick="webphone.getMediaDevices().unmute('videoinput');">
              Unmute Video
            </button>
            <button
              onclick="webphone.getMediaDevices().toggleMute('videoinput');"
            >
              Toggle Video Mute
            </button>
          </div>
        </div>
        <div class="col" style="border-right: dashed;">
          <span id="video_mute_status">State Control</span>
          <div>
            <button onclick="webphone.getMediaDevices().startPreviews();">
              Start Preview
            </button>
            <button onclick="webphone.getMediaDevices().stopPreviews();">
              Stop Preview
            </button>
            <button onclick="webphone.getMediaDevices().startStreams();">
              Start Call Streams
            </button>
            <button onclick="webphone.getMediaDevices().stopStreams();">
              Stop Call Streams
            </button>
          </div>
        </div>
      </div>

      <!-- Media Devices-->
      <div class="row" style="border: solid;">
        <div class="col" style="border-right: dashed;">
          <div id="media_device_preview"></div>
        </div>
        <div class="col" style="border-right: dashed;">
          <div id="media_device_selector"></div>
        </div>
        <div class="col">
          <div id="media_device_custom"></div>
          <script type="text/javascript">
            var template = `
              <div>
                <legend>{{i18n.legend}}</legend>
        
                {{#videoinput.enabled}}          
                  <div>
                    <label for="{{selectors.videoinput.elementId}}">
                      {{i18n.videoinput}}
                    </label>                
                    <select id="{{selectors.videoinput.elementId}}">
                      {{#videoinput.devices}}
                        {{#connected}}
                          <option value="{{id}}" {{#active}}selected{{/active}}>{{name}}</option>
                        {{/connected}}
                      {{/videoinput.devices}}
                    </select>
                  </div>
                {{/videoinput.enabled}}
        
                {{#audiooutput.enabled}}
                  <div>
                    Hello World!
                    <label for="{{selectors.audiooutput.elementId}}" style="display: inline-block">
                      {{i18n.audiooutput}}:
                    </label>
                    <span id="{{selectors.audiooutput.elementId}}">
                      {{#audiooutput.devices}}
                        {{#active}}
                          {{name}}
                        {{/active}}
                      {{/audiooutput.devices}}
                    </span>
                  </div>
                {{/audiooutput.enabled}}
        
                {{#audioinput.enabled}}
                  <div>
                    <label for="{{selectors.audioinput.elementId}}">
                      {{i18n.audioinput}}:
                    </label>
                    <div id="{{selectors.audioinput.elementId}}">
                      {{#audioinput.devices}}
                        {{#connected}}
                          <div>
                            <input type="radio" name="audioinput" value="{{id}}" {{#active}}checked="checked"{{/active}}
                            onclick="webphone.getMediaDevices().then(mediaDevices => {
                                  mediaDevices.changeDevice('audioinput', event.target.value);
                                });
                            ">
                            <label>{{name}}</label>
                          </div>
                        {{/connected}}    
                      {{/audioinput.devices}}
                    </div>               
                  </div>
                {{/audioinput.enabled}}
              </div>
              `;
            var customTemplateConfig1 = {
              template: template,
              root: {
                elementId: "media_device_custom"
              },
              selectors: {
                audioinput: {
                  elementId: "customized_audio_input"
                }
              }
            };

            /*
            webphone.getMediaDevices().then(mediaDevices => {
              mediaDevices.render(customTemplateConfig1).then(() => {
                document
                  .querySelectorAll(
                    "#customized_audio_input > div > input[type=radio]"
                  )
                  .forEach(radio => {
                    console.log(
                      "found radio button after render succeeded: ",
                      radio
                    );
                  });
              });
            });
            */

            //Added by Mahfuz
          </script>
        </div>
      </div>

      <!-- Dialpad -->
      <div class="row" style="border: solid;">
        <div class="col" style="border-right: dashed;">
          <div id="dialpad"></div>
        </div>
        <div class="col" style="border-right: dashed;">
          <div id="dialed_custom"></div>
          <div id="dialpad_custom"></div>
          <script type="text/javascript">
            var template = `
              <div>
                <p id="{{by_id.one.elementId}}" data-value="one">{{i18n.one}}</p>
                <p id="{{by_id.two.elementId}}" data-value="two">{{i18n.two}}</p>
                <p id="{{by_id.three.elementId}}" data-value="three">{{i18n.three}}</p>
                <p id="{{by_id.four.elementId}}" data-value="four">{{i18n.four}}</p>
                <p id="{{by_id.five.elementId}}" data-value="five">{{i18n.five}}</p>
                <p id="{{by_id.six.elementId}}" data-value="six">{{i18n.six}}</p>
                <p id="{{by_id.seven.elementId}}" data-value="seven">{{i18n.seven}}</p>
                <p id="{{by_id.eight.elementId}}" data-value="eight">{{i18n.eight}}</p> 
                <p id="{{by_id.nine.elementId}}" data-value="nine">{{i18n.nine}}</p>
                <p id="{{by_id.astrisk.elementId}}" data-value="astrisk">{{i18n.astrisk}}</p>
                <p id="{{by_id.zero.elementId}}" data-value="zero">{{i18n.zero}}</p>
                <p id="{{by_id.pound.elementId}}" data-value="pound">{{i18n.pound}}</p>
              </div>`;
            var customTemplateConfig = {
              template: template,
              root: {
                elementId: "dialpad_custom"
              }
            };

            webphone.getDialpad().renderAddTarget(customTemplateConfig);
          </script>
        </div>
        <div class="col"></div>
      </div>

      <!-- User Agent-->
      <div class="row" style="border: solid;">
        <div class="col" style="border-right: dashed;">
          <div id="user_agent"></div>
          </div>
        </div>
        <div class="col" style="border-right: dashed;"></div>
        <div class="col"></div>
      </div>

      <!-- Call Control -->
      <div class="row" style="border: solid;">
        <div class="col" style="border-right: dashed;">
          <div id="call_control"></div>
        </div>
        <div class="col" style="border-right: dashed;"></div>
        <div class="col"></div>
      </div>

      <!-- Call List -->
      <div class="row" style="border: solid;">
        <div class="col">
          <div id="call_list"></div>
        </div>
      </div>
    </div>
  </body>
</html>
